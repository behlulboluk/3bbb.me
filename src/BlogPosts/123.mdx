# Role Service API
---
## Roles:

>Methods: GET, POST, PATCH, DELETE
		
### 1. GET

https://api.getwebee.com/roles/user
https://api.getwebee.com/roles/user/0b16b61a-74cd-4fe8-a7a4-463d6af4ab10
	
#### Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk	

#### Response - HTTP 200:

```
[
	{
        "id": "staff_hotel_78_housekeeping_taxi_with_payments",
        "description": "Hotel department privileges for StaffApp",
        "allowed_types_and_ids": [
            "HOUSEKEEPING",
            "TAXI"
        ],
        "authorized_fields": {
            "BOOKINGS": {
                "ALL": true
            },
            "REQUESTS": {
                "ALL": true
            },
            "PAYMENTS": {
                "ALL": true
            }
        }
    },
    {
        "id": "staff_hotel_78_155_156_IN_ROOM_DINING_HOUSEKEEPING",
        "description": "Hotel admin privileges for StaffApp 155, 156",
        "allowed_types_and_ids": [
            "IN_ROOM_DINING",
            "HOUSEKEEPING",
            "155",
            "156"
        ],
        "authorized_fields": {
            "REQUESTS": {
                "ALL": true
            },
            "BOOKINGS": {
                "ALL": true
            }
        }
    },
    {
        "id": "staff_hotel_admin",
        "description": "Hotel admin privileges for StaffApp",
        "allowed_types_and_ids": [
            "ANY"
        ],
        "authorized_fields": {
            "ALACARTE": {
                "ALL": true
            },
            "BOOKINGS": {
                "ALL": true
            },
            "REQUESTS": {
                "ALL": true
            }
        }
    }
]
```

>Not: queryString olarak hotel_id zorunludur. Bütün oteller için default olarak gelen "staff_hotel_admin" rolü vardır.

### 2. GET by role_id and hotel_id

- https://api.getwebee.com/roles/${role_id}?hotel_id=${hotel_id}

- https://api.getwebee.com/roles/staff_hotel_admin?hotel_id=79

Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk


Response - HTTP 200:

```
[
    {
        "app_id": "staff",
        "role_id": "staff_hotel_admin",
        "hotel_id": "79",
        "role_key": "hotelId#79",
        "app_id_hotel_id": "staff_79",
        "id": "3bebf1ca-109c-4a94-a518-9607f4157a86"
	 "name": "Behlül Bahadır Bölük"

    },
    {
        "app_id": "staff",
        "role_id": "staff_hotel_admin",
        "hotel_id": "79",
        "role_key": "hotelId#79",
        "app_id_hotel_id": "staff_79",
        "id": "ea9e7d3a-d9f4-4542-ab0c-408ed184a1f7"
	 "name": "Hakan Suluoğlu"

    }
]
```

### 3. POST

- https://api.getwebee.com/roles

Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk

Body:

```
{
    "hotel_id": "78",
    "description": "staff hotel 78, 112, HOUSEKEEPING, IN_ROOM_DINING",
    "allowed_types_and_ids": [
        112,
        "HOUSEKEEPING"
	 "IN_ROOM_DINING"
    ]
}
```

Zorunlu alanlar: hotel_id, description, allowed_types_and_ids

>Not: allowed_types_and_ids parametresinde id ile yollanan servisler Number, types ile yollanan servisler (ör: "IN_ROOM_DINING", "TAXI") string olarak yollanmalıdır.

>Not: "IN_ROOM_DINING" servisinin id'si bulunmadığından types'ı ile yollanmalıdır.

Response - HTTP 200:

```
{
    "message": "Success"
}
```

### 4. PATCH

- https://api.getwebee.com/roles/${role_id}

- https://api.getwebee.com/roles/staff_hotel_78_112_HOUSEKEEPING_ IN_ROOM_DINING

Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk

>Not: staff_hotel_admin değiştirilemez.

Body:

```
{
    "description": "staff hotel 78, 112, HOUSEKEEPING, IN_ROOM_DINING, LAUNDRY",
    "allowed_types_and_ids": [
        112,
        "HOUSEKEEPING"
	 "IN_ROOM_DINING",
	 "LAUNDRY"
    ]
}
```

Response - HTTP 200:

```
{
    "message": "Success"
}
```

### 5. DELETE

- https://api.getwebee.com/roles/${role_id}

- https://api.getwebee.com/roles/staff_hotel_78_112_HOUSEKEEPING_ IN_ROOM_DINING

Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk

>Not: Silmek istenen role eğer bir kişiye atanmış ise silme işlemi yapamazsınız. Sadece kullanılmayan roller silinebilir. İlk önce kullanıcılardan o role kaldırıldıktan sonra silme işlemi başarılı olur.

>Not: staff_hotel_admin silinemez.

Response - HTTP 200:

```
{
    "message": "Success"
}
```

## User:
 
>Methods: GET, POST,  PATCH, DELETE

### 1. GET by Id for user's roles

- https://api.getwebee.com/roles/user/${user_id}?hotel_id=${hotel_id}

- https://api.getwebee.com/roles/user/0b16b61a-74cd-4fe8-a7a4-463d6af4ab10?hotel_id=79

Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk

Response - HTTP 200:

```
{
    "app_id": "staff",
    "role_id": "staff_hotel_admin",
    "hotel_id": "79",
    "role_key": "hotelId#79",
    "app_id_hotel_id": "staff_79",
    "id": "0b16b61a-74cd-4fe8-a7a4-463d6af4ab10",
    "name": "Behlül Bahadır Bölük"
}
```
		
### 2. POST

- https://api.getwebee.com/roles/user

Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk

Body:

```
{
    "phone_number": "+905439260717",
    "role_id": "staff_hotel_78_112_HOUSEKEEPING_ IN_ROOM_DINING",
    "hotel_id": "78",
    "name": "Behlül Bahadır Bölük"
}
```

Zorunlu alanlar: phone_number, role_id, hotel_id, name

Response - HTTP 200:

```
{
    "message": "Success"
}
```


### 3. PATCH

- https://api.getwebee.com/roles/user/${user_id}

- https://api.getwebee.com/roles/user/0b16b61a-74cd-4fe8-a7a4-463d6af4ab10

Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk


Body:

```
{
   "hotel_id": "78",
   "role_id": "staff_hotel_admin"
}
```

Zorunlu alanlar: hotel_id, role_id

Response - HTTP 200:

```
{
    "message": "Success"
}
```

### 4. DELETE

    1. https://api.getwebee.com/roles/user/${user_id}

    2. https://api.getwebee.com/roles/user/0b16b61a-74cd-4fe8-a7a4-463d6af4ab10


Headers:

	x-api-key: v8Q5cz9PfP29urKWzIiS71BqQjVt8Z7QaG6e9Xdk

Body:

```
{
   "hotel_id": "78"
}
```

Zorunlu alanlar: hotel_id

Response - HTTP 200:

```
{
    "message": "Success"
}
```

----
